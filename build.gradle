group 'io.ibj'
version '1.0-SNAPSHOT'

apply plugin: 'java'

defaultTasks 'clean', 'build', 'shadow'

repositories {
    mavenCentral()
    maven {
        url 'https://hub.spigotmc.org/nexus/content/groups/public/'
    }
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.11'
}

plugins.withType(JavaPlugin) {
    subprojects.forEach { proj ->
        proj.tasks.withType(JavaCompile) { task ->
            task.sourceCompatibility = "1.8"
            task.targetCompatibility = "1.8"
        }
    }
}

subprojects.forEach { proj ->
    proj.apply plugin: 'java'
    proj.test {
        afterTest { descriptor, result ->
            if (result.resultType == TestResult.ResultType.SUCCESS)
                logger.info("Test '" + descriptor + "' passed")
            else if (result.resultType == TestResult.ResultType.FAILURE)
                logger.log(LogLevel.ERROR, "Test $descriptor completed in error!");
        }
    }
}

